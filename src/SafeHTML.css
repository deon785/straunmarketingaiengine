/* ============================================
   SAFE HTML CONTENT STYLES - SECURITY FOCUSED
   ============================================ */

/* Base container - SECURITY FIRST */
.safe-html-content {
    /* Layout security */
    position: relative !important;
    display: block !important;
    overflow: visible !important;
    max-width: 100% !important;
    
    /* Text security */
    line-height: 1.6;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
    
    /* Prevent injection attacks */
    isolation: isolate !important;
    contain: content !important;
    
    /* Reset dangerous properties */
    all: unset !important;
}

/* Reset ALL nested elements */
.safe-html-content * {
    /* Block position-based attacks */
    position: static !important;
    z-index: 1 !important;
    
    /* Prevent overlay attacks */
    pointer-events: auto !important;
    user-select: text !important;
    
    /* Block visibility attacks */
    opacity: 1 !important;
    visibility: visible !important;
    display: revert !important;
    
    /* Prevent scroll hijacking */
    overflow: visible !important;
    overflow-x: visible !important;
    overflow-y: visible !important;
    
    /* Block size manipulation attacks */
    width: auto !important;
    height: auto !important;
    min-width: 0 !important;
    min-height: 0 !important;
    max-width: 100% !important;
    max-height: none !important;
    
    /* Prevent margin/padding attacks */
    margin: 0 !important;
    padding: 0 !important;
    top: auto !important;
    left: auto !important;
    right: auto !important;
    bottom: auto !important;
    
    /* Block transform attacks */
    transform: none !important;
    transform-origin: 50% 50% !important;
    
    /* Prevent animation attacks */
    animation: none !important;
    transition: none !important;
    
    /* Block filter attacks */
    filter: none !important;
    backdrop-filter: none !important;
    mix-blend-mode: normal !important;
    
    /* Prevent clip-path attacks */
    clip-path: none !important;
    clip: auto !important;
    
    /* Block background attacks */
    background: transparent !important;
    background-color: transparent !important;
    background-image: none !important;
}

/* ====================
   SPECIFIC ELEMENTS
   ==================== */

/* Paragraphs - safe defaults */
.safe-html-content p {
    margin: 0 0 1em 0 !important;
    padding: 0 !important;
}

/* Headings - safe defaults */
.safe-html-content h1,
.safe-html-content h2,
.safe-html-content h3,
.safe-html-content h4,
.safe-html-content h5,
.safe-html-content h6 {
    margin: 1em 0 0.5em 0 !important;
    font-weight: bold !important;
    line-height: 1.2 !important;
}

/* Lists - safe defaults */
.safe-html-content ul,
.safe-html-content ol {
    margin: 1em 0 !important;
    padding-left: 2em !important;
}

.safe-html-content li {
    margin: 0.25em 0 !important;
    padding: 0 !important;
}

/* Links - SECURE styling */
.safe-html-content a {
    color: #007bff !important;
    text-decoration: underline !important;
    cursor: pointer !important;
    display: inline !important;
    
    /* Block pseudo-element attacks */
    content: none !important;
}

/* Link hover states - FIXED syntax */
.safe-html-content a:hover,
.safe-html-content a:focus,
.safe-html-content a:active {
    color: #0056b3 !important;
    text-decoration: underline !important;
    background-color: transparent !important;
}

/* External link indicator */
.safe-html-content a[href^="http"]:not([href*="yourdomain.com"])::after {
    content: " â†—" !important;
    font-size: 0.8em !important;
    display: inline !important;
}

/* Block javascript: and data: URLs */
.safe-html-content a[href^="javascript:"],
.safe-html-content a[href^="data:"] {
    display: none !important;
    pointer-events: none !important;
}

/* ====================
   IMAGE SECURITY
   ==================== */

.safe-html-content img {
    /* Size restrictions */
    max-width: 100% !important;
    height: auto !important;
    width: auto !important;
    
    /* Layout security */
    display: inline-block !important;
    vertical-align: middle !important;
    position: relative !important;
    z-index: 1 !important;
    
    /* Block image-based attacks */
    object-fit: contain !important;
    object-position: 50% 50% !important;
    
    /* Block border/outline attacks */
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
    
    /* Block cursor attacks */
    cursor: default !important;
    
    /* Safe opacity */
    opacity: 1 !important;
    transition: opacity 0.3s ease !important;
}

/* Loading state for lazy-loaded images */
.safe-html-content img[loading="lazy"] {
    opacity: 0.3 !important;
}

/* Broken images */
.safe-html-content img:not([src]),
.safe-html-content img[src=""],
.safe-html-content img[src^="data:"]:not([src^="data:image/"]) {
    display: none !important;
}

/* Image error placeholder */
.safe-html-content img.error {
    background-color: #f5f5f5 !important;
    border: 2px dashed #ccc !important;
    padding: 20px !important;
    text-align: center !important;
    color: #666 !important;
    font-style: italic !important;
    min-height: 100px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
}

/* Image error message */
.safe-html-content .image-error {
    display: block !important;
    background-color: #fff3cd !important;
    border: 1px solid #ffeaa7 !important;
    color: #856404 !important;
    padding: 8px 12px !important;
    border-radius: 4px !important;
    margin: 5px 0 !important;
    font-size: 0.9em !important;
}

/* ====================
   BLOCK DANGEROUS ELEMENTS
   ==================== */

/* Block iframes entirely (highly recommended) */
.safe-html-content iframe,
.safe-html-content object,
.safe-html-content embed,
.safe-html-content canvas,
.safe-html-content video,
.safe-html-content audio {
    display: none !important;
    visibility: hidden !important;
    width: 0 !important;
    height: 0 !important;
    opacity: 0 !important;
}

/* Block form elements */
.safe-html-content form,
.safe-html-content input,
.safe-html-content textarea,
.safe-html-content select,
.safe-html-content button {
    display: none !important;
}

/* Block scripts and styles */
.safe-html-content script,
.safe-html-content style,
.safe-html-content link,
.safe-html-content meta {
    display: none !important;
}

/* Block potentially dangerous elements */
.safe-html-content svg,
.safe-html-content math,
.safe-html-content dialog,
.safe-html-content details,
.safe-html-content summary,
.safe-html-content template {
    display: none !important;
}

/* ====================
   TEXT FORMATTING
   ==================== */

/* Bold/Italic - safe */
.safe-html-content b,
.safe-html-content strong {
    font-weight: bold !important;
}

.safe-html-content i,
.safe-html-content em {
    font-style: italic !important;
}

/* Code - safe display */
.safe-html-content code,
.safe-html-content pre {
    font-family: monospace !important;
    background-color: #f5f5f5 !important;
    padding: 2px 4px !important;
    border-radius: 3px !important;
    font-size: 0.9em !important;
}

.safe-html-content pre {
    padding: 1em !important;
    overflow-x: auto !important;
    white-space: pre-wrap !important;
}

/* Blockquote - safe */
.safe-html-content blockquote {
    border-left: 4px solid #ddd !important;
    margin: 1em 0 !important;
    padding: 0.5em 1em !important;
    color: #666 !important;
    font-style: italic !important;
}

/* ====================
   ADDITIONAL SECURITY
   ==================== */

/* Prevent CSS injection via content property */
.safe-html-content *::before,
.safe-html-content *::after {
    content: none !important;
    display: none !important;
}

/* Prevent attribute-based attacks */
.safe-html-content *[style*="position:fixed"],
.safe-html-content *[style*="position: absolute"],
.safe-html-content *[style*="z-index:9999"],
.safe-html-content *[style*="opacity:0"],
.safe-html-content *[style*="display:none"],
.safe-html-content *[style*="visibility:hidden"] {
    position: static !important;
    z-index: 1 !important;
    opacity: 1 !important;
    display: block !important;
    visibility: visible !important;
}

/* ====================
   RESPONSIVE SAFETY
   ==================== */

@media (max-width: 768px) {
    .safe-html-content {
        font-size: 14px !important;
    }
    
    .safe-html-content img {
        max-width: 100vw !important;
    }
}

/* Print safety */
@media print {
    .safe-html-content {
        color: #000 !important;
        background: #fff !important;
    }
    
    .safe-html-content a {
        color: #000 !important;
        text-decoration: underline !important;
    }
    
    .safe-html-content a[href]::after {
        content: " (" attr(href) ")" !important;
    }
}